<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="amino">





<title>NewStar2024_week4&amp;5 | 《普通生物学》第四版2.5.2</title>



    <link rel="icon" href="/logo1.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="《普通生物学》第四版2.5.2" type="application/atom+xml">
</head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">《普通生物学》第四版2.5.2</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">《普通生物学》第四版2.5.2</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">NewStar2024_week4&amp;5</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">amino</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">October 22, 2024&nbsp;&nbsp;14:08:04</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="解出题目"><a href="#解出题目" class="headerlink" title="解出题目"></a>解出题目</h2><table>
<thead>
<tr>
<th>类型</th>
<th>题目名称</th>
<th>分数</th>
</tr>
</thead>
<tbody><tr>
<td>Misc</td>
<td>扫码领取flag</td>
<td>112</td>
</tr>
<tr>
<td>Misc</td>
<td>Alt</td>
<td>170</td>
</tr>
</tbody></table>
<h2 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h2><h3 id="Misc-扫码领取flag-112"><a href="#Misc-扫码领取flag-112" class="headerlink" title="Misc  扫码领取flag  112"></a>Misc  扫码领取flag  112</h3><p>crc爆破修改宽高</p>
<p><img src="/2024-10-22-NewStar2024-week4-5/4-1.png" alt="4-1"></p>
<p><img src="/2024-10-22-NewStar2024-week4-5/4-2.png" alt="4-2"></p>
<p>拿到图片</p>
<p><img src="/2024-10-22-NewStar2024-week4-5/4-3.png" alt="4-3"></p>
<p>AZTEC码，<a target="_blank" rel="noopener" href="https://products.aspose.app/barcode/zh-hans/recognize/aztec#/recognized">在线阅读Aztec条码</a> 在线扫描拿到flag</p>
<p>flag{Then_d0_you_kn0w_w6at_Hanx1n_cod3_1s?}</p>
<p>hint的存在意义是什么，而且这也不是汉信码啊</p>
<h3 id="Misc-Alt-170"><a href="#Misc-Alt-170" class="headerlink" title="Misc  Alt  170"></a>Misc  Alt  170</h3><p>参考链接：<a target="_blank" rel="noopener" href="https://github.com/p0ise/pcap2text">https://github.com/p0ise/pcap2text</a></p>
<p>以usb.src &#x3D;&#x3D; “1.5.1”过滤，另存为另一个文件</p>
<p><img src="/2024-10-22-NewStar2024-week4-5/4-4.png" alt="4-4"></p>
<p>脚本如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> tempfile <span class="keyword">import</span> NamedTemporaryFile</span><br><span class="line"></span><br><span class="line">BOOT_KEYBOARD_MAP = &#123;</span><br><span class="line">    <span class="number">0x00</span>: (<span class="literal">None</span>, <span class="literal">None</span>),                         <span class="comment"># Reserved (no event indicated)</span></span><br><span class="line">    <span class="number">0x01</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># ErrorRollOver</span></span><br><span class="line">    <span class="number">0x02</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># POSTFail</span></span><br><span class="line">    <span class="number">0x03</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># ErrorUndefined</span></span><br><span class="line">    <span class="number">0x04</span>: (<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;A&#x27;</span>),                           <span class="comment"># a</span></span><br><span class="line">    <span class="number">0x05</span>: (<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;B&#x27;</span>),                           <span class="comment"># b</span></span><br><span class="line">    <span class="number">0x06</span>: (<span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;C&#x27;</span>),                           <span class="comment"># c</span></span><br><span class="line">    <span class="number">0x07</span>: (<span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;D&#x27;</span>),                           <span class="comment"># d</span></span><br><span class="line">    <span class="number">0x08</span>: (<span class="string">&#x27;e&#x27;</span>, <span class="string">&#x27;E&#x27;</span>),                           <span class="comment"># e</span></span><br><span class="line">    <span class="number">0x09</span>: (<span class="string">&#x27;f&#x27;</span>, <span class="string">&#x27;F&#x27;</span>),                           <span class="comment"># f</span></span><br><span class="line">    <span class="number">0x0a</span>: (<span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;G&#x27;</span>),                           <span class="comment"># g</span></span><br><span class="line">    <span class="number">0x0b</span>: (<span class="string">&#x27;h&#x27;</span>, <span class="string">&#x27;H&#x27;</span>),                           <span class="comment"># h</span></span><br><span class="line">    <span class="number">0x0c</span>: (<span class="string">&#x27;i&#x27;</span>, <span class="string">&#x27;I&#x27;</span>),                           <span class="comment"># i</span></span><br><span class="line">    <span class="number">0x0d</span>: (<span class="string">&#x27;j&#x27;</span>, <span class="string">&#x27;J&#x27;</span>),                           <span class="comment"># j</span></span><br><span class="line">    <span class="number">0x0e</span>: (<span class="string">&#x27;k&#x27;</span>, <span class="string">&#x27;K&#x27;</span>),                           <span class="comment"># k</span></span><br><span class="line">    <span class="number">0x0f</span>: (<span class="string">&#x27;l&#x27;</span>, <span class="string">&#x27;L&#x27;</span>),                           <span class="comment"># l</span></span><br><span class="line">    <span class="number">0x10</span>: (<span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;M&#x27;</span>),                           <span class="comment"># m</span></span><br><span class="line">    <span class="number">0x11</span>: (<span class="string">&#x27;n&#x27;</span>, <span class="string">&#x27;N&#x27;</span>),                           <span class="comment"># n</span></span><br><span class="line">    <span class="number">0x12</span>: (<span class="string">&#x27;o&#x27;</span>, <span class="string">&#x27;O&#x27;</span>),                           <span class="comment"># o</span></span><br><span class="line">    <span class="number">0x13</span>: (<span class="string">&#x27;p&#x27;</span>, <span class="string">&#x27;P&#x27;</span>),                           <span class="comment"># p</span></span><br><span class="line">    <span class="number">0x14</span>: (<span class="string">&#x27;q&#x27;</span>, <span class="string">&#x27;Q&#x27;</span>),                           <span class="comment"># q</span></span><br><span class="line">    <span class="number">0x15</span>: (<span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;R&#x27;</span>),                           <span class="comment"># r</span></span><br><span class="line">    <span class="number">0x16</span>: (<span class="string">&#x27;s&#x27;</span>, <span class="string">&#x27;S&#x27;</span>),                           <span class="comment"># s</span></span><br><span class="line">    <span class="number">0x17</span>: (<span class="string">&#x27;t&#x27;</span>, <span class="string">&#x27;T&#x27;</span>),                           <span class="comment"># t</span></span><br><span class="line">    <span class="number">0x18</span>: (<span class="string">&#x27;u&#x27;</span>, <span class="string">&#x27;U&#x27;</span>),                           <span class="comment"># u</span></span><br><span class="line">    <span class="number">0x19</span>: (<span class="string">&#x27;v&#x27;</span>, <span class="string">&#x27;V&#x27;</span>),                           <span class="comment"># v</span></span><br><span class="line">    <span class="number">0x1a</span>: (<span class="string">&#x27;w&#x27;</span>, <span class="string">&#x27;W&#x27;</span>),                           <span class="comment"># w</span></span><br><span class="line">    <span class="number">0x1b</span>: (<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;X&#x27;</span>),                           <span class="comment"># x</span></span><br><span class="line">    <span class="number">0x1c</span>: (<span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;Y&#x27;</span>),                           <span class="comment"># y</span></span><br><span class="line">    <span class="number">0x1d</span>: (<span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;Z&#x27;</span>),                           <span class="comment"># z</span></span><br><span class="line">    <span class="number">0x1e</span>: (<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;!&#x27;</span>),                           <span class="comment"># 1</span></span><br><span class="line">    <span class="number">0x1f</span>: (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;@&#x27;</span>),                           <span class="comment"># 2</span></span><br><span class="line">    <span class="number">0x20</span>: (<span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;#&#x27;</span>),                           <span class="comment"># 3</span></span><br><span class="line">    <span class="number">0x21</span>: (<span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;$&#x27;</span>),                           <span class="comment"># 4</span></span><br><span class="line">    <span class="number">0x22</span>: (<span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;%&#x27;</span>),                           <span class="comment"># 5</span></span><br><span class="line">    <span class="number">0x23</span>: (<span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;^&#x27;</span>),                           <span class="comment"># 6</span></span><br><span class="line">    <span class="number">0x24</span>: (<span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>),                           <span class="comment"># 7</span></span><br><span class="line">    <span class="number">0x25</span>: (<span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;*&#x27;</span>),                           <span class="comment"># 8</span></span><br><span class="line">    <span class="number">0x26</span>: (<span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;(&#x27;</span>),                           <span class="comment"># 9</span></span><br><span class="line">    <span class="number">0x27</span>: (<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;)&#x27;</span>),                           <span class="comment"># 0</span></span><br><span class="line">    <span class="number">0x28</span>: (<span class="string">&#x27;\n&#x27;</span>, <span class="string">&#x27;\n&#x27;</span>),                         <span class="comment"># Return (ENTER)</span></span><br><span class="line">    <span class="number">0x29</span>: (<span class="string">&#x27;[ESC]&#x27;</span>, <span class="string">&#x27;[ESC]&#x27;</span>),                   <span class="comment"># Escape</span></span><br><span class="line">    <span class="number">0x2a</span>: (<span class="string">&#x27;\b&#x27;</span>, <span class="string">&#x27;\b&#x27;</span>),                         <span class="comment"># Backspace</span></span><br><span class="line">    <span class="number">0x2b</span>: (<span class="string">&#x27;\t&#x27;</span>, <span class="string">&#x27;\t&#x27;</span>),                         <span class="comment"># Tab</span></span><br><span class="line">    <span class="number">0x2c</span>: (<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27; &#x27;</span>),                           <span class="comment"># Spacebar</span></span><br><span class="line">    <span class="number">0x2d</span>: (<span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;_&#x27;</span>),                           <span class="comment"># -</span></span><br><span class="line">    <span class="number">0x2e</span>: (<span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;+&#x27;</span>),                           <span class="comment"># =</span></span><br><span class="line">    <span class="number">0x2f</span>: (<span class="string">&#x27;[&#x27;</span>, <span class="string">&#x27;&#123;&#x27;</span>),                           <span class="comment"># [</span></span><br><span class="line">    <span class="number">0x30</span>: (<span class="string">&#x27;]&#x27;</span>, <span class="string">&#x27;&#125;&#x27;</span>),                           <span class="comment"># ]</span></span><br><span class="line">    <span class="number">0x31</span>: (<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;|&#x27;</span>),                          <span class="comment"># \</span></span><br><span class="line">    <span class="number">0x32</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Non-US # and ~</span></span><br><span class="line">    <span class="number">0x33</span>: (<span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;:&#x27;</span>),                           <span class="comment"># ;</span></span><br><span class="line">    <span class="number">0x34</span>: (<span class="string">&#x27;\&#x27;&#x27;</span>, <span class="string">&#x27;&quot;&#x27;</span>),                          <span class="comment"># &#x27;</span></span><br><span class="line">    <span class="number">0x35</span>: (<span class="string">&#x27;`&#x27;</span>, <span class="string">&#x27;~&#x27;</span>),                           <span class="comment"># `</span></span><br><span class="line">    <span class="number">0x36</span>: (<span class="string">&#x27;,&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>),                           <span class="comment"># ,</span></span><br><span class="line">    <span class="number">0x37</span>: (<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>),                           <span class="comment"># .</span></span><br><span class="line">    <span class="number">0x38</span>: (<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;?&#x27;</span>),                           <span class="comment"># /</span></span><br><span class="line">    <span class="number">0x39</span>: (<span class="string">&#x27;[CAPSLOCK]&#x27;</span>, <span class="string">&#x27;[CAPSLOCK]&#x27;</span>),         <span class="comment"># Caps Lock</span></span><br><span class="line">    <span class="number">0x3a</span>: (<span class="string">&#x27;[F1]&#x27;</span>, <span class="string">&#x27;[F1]&#x27;</span>),                     <span class="comment"># F1</span></span><br><span class="line">    <span class="number">0x3b</span>: (<span class="string">&#x27;[F2]&#x27;</span>, <span class="string">&#x27;[F2]&#x27;</span>),                     <span class="comment"># F2</span></span><br><span class="line">    <span class="number">0x3c</span>: (<span class="string">&#x27;[F3]&#x27;</span>, <span class="string">&#x27;[F3]&#x27;</span>),                     <span class="comment"># F3</span></span><br><span class="line">    <span class="number">0x3d</span>: (<span class="string">&#x27;[F4]&#x27;</span>, <span class="string">&#x27;[F4]&#x27;</span>),                     <span class="comment"># F4</span></span><br><span class="line">    <span class="number">0x3e</span>: (<span class="string">&#x27;[F5]&#x27;</span>, <span class="string">&#x27;[F5]&#x27;</span>),                     <span class="comment"># F5</span></span><br><span class="line">    <span class="number">0x3f</span>: (<span class="string">&#x27;[F6]&#x27;</span>, <span class="string">&#x27;[F6]&#x27;</span>),                     <span class="comment"># F6</span></span><br><span class="line">    <span class="number">0x40</span>: (<span class="string">&#x27;[F7]&#x27;</span>, <span class="string">&#x27;[F7]&#x27;</span>),                     <span class="comment"># F7</span></span><br><span class="line">    <span class="number">0x41</span>: (<span class="string">&#x27;[F8]&#x27;</span>, <span class="string">&#x27;[F8]&#x27;</span>),                     <span class="comment"># F8</span></span><br><span class="line">    <span class="number">0x42</span>: (<span class="string">&#x27;[F9]&#x27;</span>, <span class="string">&#x27;[F9]&#x27;</span>),                     <span class="comment"># F9</span></span><br><span class="line">    <span class="number">0x43</span>: (<span class="string">&#x27;[F10]&#x27;</span>, <span class="string">&#x27;[F10]&#x27;</span>),                   <span class="comment"># F10</span></span><br><span class="line">    <span class="number">0x44</span>: (<span class="string">&#x27;[F11]&#x27;</span>, <span class="string">&#x27;[F11]&#x27;</span>),                   <span class="comment"># F11</span></span><br><span class="line">    <span class="number">0x45</span>: (<span class="string">&#x27;[F12]&#x27;</span>, <span class="string">&#x27;[F12]&#x27;</span>),                   <span class="comment"># F12</span></span><br><span class="line">    <span class="number">0x46</span>: (<span class="string">&#x27;[PRINTSCREEN]&#x27;</span>, <span class="string">&#x27;[PRINTSCREEN]&#x27;</span>),   <span class="comment"># Print Screen</span></span><br><span class="line">    <span class="number">0x47</span>: (<span class="string">&#x27;[SCROLLLOCK]&#x27;</span>, <span class="string">&#x27;[SCROLLLOCK]&#x27;</span>),     <span class="comment"># Scroll Lock</span></span><br><span class="line">    <span class="number">0x48</span>: (<span class="string">&#x27;[PAUSE]&#x27;</span>, <span class="string">&#x27;[PAUSE]&#x27;</span>),               <span class="comment"># Pause</span></span><br><span class="line">    <span class="number">0x49</span>: (<span class="string">&#x27;[INSERT]&#x27;</span>, <span class="string">&#x27;[INSERT]&#x27;</span>),             <span class="comment"># Insert</span></span><br><span class="line">    <span class="number">0x4a</span>: (<span class="string">&#x27;[HOME]&#x27;</span>, <span class="string">&#x27;[HOME]&#x27;</span>),                 <span class="comment"># Home</span></span><br><span class="line">    <span class="number">0x4b</span>: (<span class="string">&#x27;[PAGEUP]&#x27;</span>, <span class="string">&#x27;[PAGEUP]&#x27;</span>),             <span class="comment"># Page Up</span></span><br><span class="line">    <span class="number">0x4c</span>: (<span class="string">&#x27;[DELETE]&#x27;</span>, <span class="string">&#x27;[DELETE]&#x27;</span>),             <span class="comment"># Delete Forward</span></span><br><span class="line">    <span class="number">0x4d</span>: (<span class="string">&#x27;[END]&#x27;</span>, <span class="string">&#x27;[END]&#x27;</span>),                   <span class="comment"># End</span></span><br><span class="line">    <span class="number">0x4e</span>: (<span class="string">&#x27;[PAGEDOWN]&#x27;</span>, <span class="string">&#x27;[PAGEDOWN]&#x27;</span>),         <span class="comment"># Page Down</span></span><br><span class="line">    <span class="number">0x4f</span>: (<span class="string">&#x27;[RIGHTARROW]&#x27;</span>, <span class="string">&#x27;[RIGHTARROW]&#x27;</span>),     <span class="comment"># Right Arrow</span></span><br><span class="line">    <span class="number">0x50</span>: (<span class="string">&#x27;[LEFTARROW]&#x27;</span>, <span class="string">&#x27;[LEFTARROW]&#x27;</span>),       <span class="comment"># Left Arrow</span></span><br><span class="line">    <span class="number">0x51</span>: (<span class="string">&#x27;[DOWNARROW]&#x27;</span>, <span class="string">&#x27;[DOWNARROW]&#x27;</span>),       <span class="comment"># Down Arrow</span></span><br><span class="line">    <span class="number">0x52</span>: (<span class="string">&#x27;[UPARROW]&#x27;</span>, <span class="string">&#x27;[UPARROW]&#x27;</span>),           <span class="comment"># Up Arrow</span></span><br><span class="line">    <span class="number">0x53</span>: (<span class="string">&#x27;[NUMLOCK]&#x27;</span>, <span class="string">&#x27;[NUMLOCK]&#x27;</span>),           <span class="comment"># Num Lock</span></span><br><span class="line">    <span class="number">0x54</span>: (<span class="string">&#x27;[KEYPADSLASH]&#x27;</span>, <span class="string">&#x27;/&#x27;</span>),               <span class="comment"># Keypad /</span></span><br><span class="line">    <span class="number">0x55</span>: (<span class="string">&#x27;[KEYPADASTERISK]&#x27;</span>, <span class="string">&#x27;*&#x27;</span>),            <span class="comment"># Keypad *</span></span><br><span class="line">    <span class="number">0x56</span>: (<span class="string">&#x27;[KEYPADMINUS]&#x27;</span>, <span class="string">&#x27;-&#x27;</span>),               <span class="comment"># Keypad -</span></span><br><span class="line">    <span class="number">0x57</span>: (<span class="string">&#x27;[KEYPADPLUS]&#x27;</span>, <span class="string">&#x27;+&#x27;</span>),                <span class="comment"># Keypad +</span></span><br><span class="line">    <span class="number">0x58</span>: (<span class="string">&#x27;[KEYPADENTER]&#x27;</span>, <span class="string">&#x27;[KEYPADENTER]&#x27;</span>),   <span class="comment"># Keypad ENTER</span></span><br><span class="line">    <span class="number">0x59</span>: (<span class="string">&#x27;[KEYPAD1]&#x27;</span>, <span class="string">&#x27;1&#x27;</span>),                   <span class="comment"># Keypad 1 and End</span></span><br><span class="line">    <span class="number">0x5a</span>: (<span class="string">&#x27;[KEYPAD2]&#x27;</span>, <span class="string">&#x27;2&#x27;</span>),                   <span class="comment"># Keypad 2 and Down Arrow</span></span><br><span class="line">    <span class="number">0x5b</span>: (<span class="string">&#x27;[KEYPAD3]&#x27;</span>, <span class="string">&#x27;3&#x27;</span>),                   <span class="comment"># Keypad 3 and PageDn</span></span><br><span class="line">    <span class="number">0x5c</span>: (<span class="string">&#x27;[KEYPAD4]&#x27;</span>, <span class="string">&#x27;4&#x27;</span>),                   <span class="comment"># Keypad 4 and Left Arrow</span></span><br><span class="line">    <span class="number">0x5d</span>: (<span class="string">&#x27;[KEYPAD5]&#x27;</span>, <span class="string">&#x27;5&#x27;</span>),                   <span class="comment"># Keypad 5</span></span><br><span class="line">    <span class="number">0x5e</span>: (<span class="string">&#x27;[KEYPAD6]&#x27;</span>, <span class="string">&#x27;6&#x27;</span>),                   <span class="comment"># Keypad 6 and Right Arrow</span></span><br><span class="line">    <span class="number">0x5f</span>: (<span class="string">&#x27;[KEYPAD7]&#x27;</span>, <span class="string">&#x27;7&#x27;</span>),                   <span class="comment"># Keypad 7 and Home</span></span><br><span class="line">    <span class="number">0x60</span>: (<span class="string">&#x27;[KEYPAD8]&#x27;</span>, <span class="string">&#x27;8&#x27;</span>),                   <span class="comment"># Keypad 8 and Up Arrow</span></span><br><span class="line">    <span class="number">0x61</span>: (<span class="string">&#x27;[KEYPAD9]&#x27;</span>, <span class="string">&#x27;9&#x27;</span>),                   <span class="comment"># Keypad 9 and Page Up</span></span><br><span class="line">    <span class="number">0x62</span>: (<span class="string">&#x27;[KEYPAD0]&#x27;</span>, <span class="string">&#x27;0&#x27;</span>),                   <span class="comment"># Keypad 0 and Insert</span></span><br><span class="line">    <span class="number">0x63</span>: (<span class="string">&#x27;[KEYPADPERIOD]&#x27;</span>, <span class="string">&#x27;.&#x27;</span>),              <span class="comment"># Keypad . and Delete</span></span><br><span class="line">    <span class="number">0x64</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Non-US \ and |</span></span><br><span class="line">    <span class="number">0x65</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Application</span></span><br><span class="line">    <span class="number">0x66</span>: (<span class="string">&#x27;&#x27;</span>, <span class="string">&#x27;&#x27;</span>),                             <span class="comment"># Power</span></span><br><span class="line">    <span class="number">0x67</span>: (<span class="string">&#x27;[KEYPADEQUALS]&#x27;</span>, <span class="string">&#x27;=&#x27;</span>),              <span class="comment"># Keypad =</span></span><br><span class="line">    <span class="number">0x68</span>: (<span class="string">&#x27;[F13]&#x27;</span>, <span class="string">&#x27;[F13]&#x27;</span>),                   <span class="comment"># F13</span></span><br><span class="line">    <span class="number">0x69</span>: (<span class="string">&#x27;[F14]&#x27;</span>, <span class="string">&#x27;[F14]&#x27;</span>),                   <span class="comment"># F14</span></span><br><span class="line">    <span class="number">0x6a</span>: (<span class="string">&#x27;[F15]&#x27;</span>, <span class="string">&#x27;[F15]&#x27;</span>),                   <span class="comment"># F15</span></span><br><span class="line">    <span class="number">0x6b</span>: (<span class="string">&#x27;[F16]&#x27;</span>, <span class="string">&#x27;[F16]&#x27;</span>),                   <span class="comment"># F16</span></span><br><span class="line">    <span class="number">0x6c</span>: (<span class="string">&#x27;[F17]&#x27;</span>, <span class="string">&#x27;[F17]&#x27;</span>),                   <span class="comment"># F17</span></span><br><span class="line">    <span class="number">0x6d</span>: (<span class="string">&#x27;[F18]&#x27;</span>, <span class="string">&#x27;[F18]&#x27;</span>),                   <span class="comment"># F18</span></span><br><span class="line">    <span class="number">0x6e</span>: (<span class="string">&#x27;[F19]&#x27;</span>, <span class="string">&#x27;[F19]&#x27;</span>),                   <span class="comment"># F19</span></span><br><span class="line">    <span class="number">0x6f</span>: (<span class="string">&#x27;[F20]&#x27;</span>, <span class="string">&#x27;[F20]&#x27;</span>),                   <span class="comment"># F20</span></span><br><span class="line">    <span class="number">0x70</span>: (<span class="string">&#x27;[F21]&#x27;</span>, <span class="string">&#x27;[F21]&#x27;</span>),                   <span class="comment"># F21</span></span><br><span class="line">    <span class="number">0x71</span>: (<span class="string">&#x27;[F22]&#x27;</span>, <span class="string">&#x27;[F22]&#x27;</span>),                   <span class="comment"># F22</span></span><br><span class="line">    <span class="number">0x72</span>: (<span class="string">&#x27;[F23]&#x27;</span>, <span class="string">&#x27;[F23]&#x27;</span>),                   <span class="comment"># F23</span></span><br><span class="line">    <span class="number">0x73</span>: (<span class="string">&#x27;[F24]&#x27;</span>, <span class="string">&#x27;[F24]&#x27;</span>),                   <span class="comment"># F24</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_boot_keyboard_report</span>(<span class="params">data: <span class="built_in">bytearray</span></span>):</span><br><span class="line">    <span class="comment"># 数据解析</span></span><br><span class="line">    modifiers = data[<span class="number">0</span>]  <span class="comment"># 修改键字节</span></span><br><span class="line">    keys = data[<span class="number">2</span>:<span class="number">8</span>]      <span class="comment"># 键码字节</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将修改键字节中的位解码为按键修饰符</span></span><br><span class="line">    ctrl = (modifiers &amp; <span class="number">0x11</span>) != <span class="number">0</span></span><br><span class="line">    shift = (modifiers &amp; <span class="number">0x22</span>) != <span class="number">0</span></span><br><span class="line">    alt = (modifiers &amp; <span class="number">0x44</span>) != <span class="number">0</span></span><br><span class="line">    gui = (modifiers &amp; <span class="number">0x88</span>) != <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解析键码字节并将其映射为字符</span></span><br><span class="line">    characters = []</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keys:</span><br><span class="line">        <span class="keyword">if</span> key != <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># 键码不为0则查询映射表</span></span><br><span class="line">            <span class="keyword">if</span> key <span class="keyword">in</span> BOOT_KEYBOARD_MAP:</span><br><span class="line">                characters.append(BOOT_KEYBOARD_MAP[key][shift])</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                characters.append(<span class="literal">None</span>)</span><br><span class="line">    <span class="keyword">return</span> (ctrl, shift, alt, gui, characters)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">help_formatter</span>(<span class="params">prog</span>):</span><br><span class="line">    <span class="keyword">return</span> argparse.HelpFormatter(prog, max_help_position=<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="comment"># 解析命令行参数</span></span><br><span class="line">    parser = argparse.ArgumentParser(</span><br><span class="line">        description=<span class="string">&#x27;Parse keyboard report data and output as text&#x27;</span>, formatter_class=help_formatter)</span><br><span class="line">    parser.add_argument(<span class="string">&#x27;pcapng_file&#x27;</span>, <span class="built_in">help</span>=<span class="string">&#x27;path to the pcapng file&#x27;</span>)</span><br><span class="line">    args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 通过tshark解析pcapng文件，获取键盘数据包</span></span><br><span class="line">    tmpfile = NamedTemporaryFile(delete=<span class="literal">False</span>)</span><br><span class="line">    tmpfile.close()</span><br><span class="line"></span><br><span class="line">    command = <span class="string">&quot;tshark -r %s -T fields -e usbhid.data -e usb.capdata &gt; %s&quot;</span> % (</span><br><span class="line">        args.pcapng_file, tmpfile.name)</span><br><span class="line">    os.system(command)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(tmpfile.name, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line"></span><br><span class="line">    os.unlink(tmpfile.name)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解析键盘数据包，获取输入字符</span></span><br><span class="line">    text = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">        capdata = line.strip().replace(<span class="string">&#x27;:&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> capdata:</span><br><span class="line">            data = <span class="built_in">bytearray</span>.fromhex(capdata)</span><br><span class="line">            characters = parse_boot_keyboard_report(data)[-<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">for</span> character <span class="keyword">in</span> characters:</span><br><span class="line">                <span class="keyword">if</span> character:</span><br><span class="line">                    text += character</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    raw_text = <span class="built_in">repr</span>(text)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Raw output:\n<span class="subst">&#123;raw_text&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;Text output:\n<span class="subst">&#123;text&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>根据0000000000000000分段+手动调整得到ASCII码的断句</p>
<p>102 108 97 103 123 38190 30424 27969 37327 95 119 105 116 104 95 97 108 116 95 21644 31383 25143 95 495395 53 111 48 79 79 48 111 95 37239 125</p>
<p><img src="/2024-10-22-NewStar2024-week4-5/4-5.png" alt="4-5"></p>
<p>flag{键盘流量_with_alt_和窗户_15_5o0OO0o_酷}</p>
<h2 id="解出题目-1"><a href="#解出题目-1" class="headerlink" title="解出题目"></a>解出题目</h2><table>
<thead>
<tr>
<th>类型</th>
<th>题目名称</th>
<th>分数</th>
</tr>
</thead>
<tbody><tr>
<td>Misc</td>
<td>pyjail</td>
<td>500</td>
</tr>
<tr>
<td>Misc</td>
<td>zipmaster</td>
<td>420</td>
</tr>
<tr>
<td>Crypto</td>
<td>没e也能玩</td>
<td>94</td>
</tr>
</tbody></table>
<h2 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h2><h3 id="Misc-pyjail-500"><a href="#Misc-pyjail-500" class="headerlink" title="Misc  pyjail  500"></a>Misc  pyjail  500</h3><p><img src="/2024-10-22-NewStar2024-week4-5/5-1.png" alt="5-1"></p>
<p>黑名单里有什么</p>
<p>. [ + # \ “ {</p>
<p>搜了一下找到答案了这是，，<a target="_blank" rel="noopener" href="https://hzy2003628.top/2024/02/17/2024VNCTF-WP/">VNCTF2024-WP</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">match</span> <span class="built_in">vars</span>():</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">object</span>(items=i):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"><span class="keyword">match</span> <span class="built_in">list</span>(i()):</span><br><span class="line">    <span class="keyword">case</span> <span class="built_in">object</span>(pop=p):</span><br><span class="line">        <span class="keyword">match</span> <span class="built_in">list</span>(p(<span class="number">6</span>)):</span><br><span class="line">            <span class="keyword">case</span> <span class="built_in">object</span>(pop=p):</span><br><span class="line">                <span class="keyword">match</span> p():</span><br><span class="line">                    <span class="keyword">case</span> <span class="built_in">object</span>(__dict__=d):</span><br><span class="line">                        <span class="keyword">match</span> d:</span><br><span class="line">                            <span class="keyword">case</span> <span class="built_in">object</span>(values=v):</span><br><span class="line">                                <span class="keyword">match</span> <span class="built_in">list</span>(v()):</span><br><span class="line">                                    <span class="keyword">case</span> <span class="built_in">object</span>(pop=p):</span><br><span class="line">                                        p(<span class="number">12</span>)()</span><br></pre></td></tr></table></figure>

<p>调用os执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&#x27;os&#x27;).system(&#x27;/bin/bash&#x27;)</span><br></pre></td></tr></table></figure>

<p><img src="/2024-10-22-NewStar2024-week4-5/5-2.png" alt="5-2"></p>
<p>flag{U_R_the_m4ster_0f_Pyth0n_jai1!}</p>
<h3 id="Misc-zipmaster-420"><a href="#Misc-zipmaster-420" class="headerlink" title="Misc  zipmaster  420"></a>Misc  zipmaster  420</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import binascii</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">def crack_crc():</span><br><span class="line">    print(&#x27;-------------Start Crack CRC-------------&#x27;)</span><br><span class="line">    crc_list = [0x2b17958, 0xafa8f8df, 0xcc09984b, 0x242026cf]#文件的CRC32值列表，注意顺序</span><br><span class="line">    comment = &#x27;&#x27;</span><br><span class="line">    chars = string.printable</span><br><span class="line">    for crc_value in crc_list:</span><br><span class="line">        for char1 in chars:</span><br><span class="line">            for char2 in chars:</span><br><span class="line">                for char3 in chars:</span><br><span class="line">                    res_char = char1 + char2 + char3#获取遍历的任意3Byte字符</span><br><span class="line">                    char_crc = binascii.crc32(res_char.encode())#获取遍历字符的CRC32值</span><br><span class="line">                    calc_crc = char_crc &amp; 0xffffffff#将遍历的字符的CRC32值与0xffffffff进行与运算</span><br><span class="line">                    if calc_crc == crc_value:#将获取字符的CRC32值与每个文件的CRC32值进行匹配</span><br><span class="line">                        print(&#x27;[+] &#123;&#125;: &#123;&#125;&#x27;.format(hex(crc_value),res_char))</span><br><span class="line">                        comment += res_char</span><br><span class="line">    print(&#x27;-----------CRC Crack Completed-----------&#x27;)</span><br><span class="line">    print(&#x27;Result: &#123;&#125;&#x27;.format(comment))</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    crack_crc()</span><br></pre></td></tr></table></figure>

<p><img src="/2024-10-22-NewStar2024-week4-5/5-3.png" alt="5-3"></p>
<p>this_is_key!</p>
<p>解压拿到114514.zip，再解压拿到hint.txt和0712.zip</p>
<p>0712.zip里也有个hint.txt，外面的hint：看起来好像和某个文件是一样的欸</p>
<p>使用明文攻击，hint.txt压缩为hint.zip，crc一致</p>
<p><img src="/2024-10-22-NewStar2024-week4-5/5-4.png" alt="5-4"></p>
<p><img src="/2024-10-22-NewStar2024-week4-5/5-5.png" alt="5-5"></p>
<p>保存为无密码的0721_decrypted.zip，解压拿到flag.zip</p>
<p>flag.zip如果解压会有256G，明显不是这么做，010打开发现最后有base64编码</p>
<p><img src="/2024-10-22-NewStar2024-week4-5/5-6.png" alt="5-6"></p>
<p>解码保存为新的16进制文件，发现是zip</p>
<p><img src="/2024-10-22-NewStar2024-week4-5/5-7.png" alt="5-7"></p>
<p>根据提示，密码是不可见字符</p>
<p>参考链接2有脚本</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import base64</span><br><span class="line">import pyzipper</span><br><span class="line"></span><br><span class="line">target_zip = &#x27;newflag.zip&#x27;</span><br><span class="line">outfile = &#x27;./solved&#x27;</span><br><span class="line"></span><br><span class="line">pwd = base64.b64decode(b&#x27;f4tj4oGMRuI=&#x27;)</span><br><span class="line"># b&#x27;hE\xe2\x80\x8bcT\xe2\x80\x8cF\xe2\x80\x8f&#x27;</span><br><span class="line">with pyzipper.AESZipFile(target_zip, &#x27;r&#x27;) as f:</span><br><span class="line">    f.pwd = pwd</span><br><span class="line">    f.extractall(outfile)</span><br></pre></td></tr></table></figure>

<p>解压得到Z1文件，记事本打开拿到flag{ecebbd61-2bb9-4eda-b4ca-f24b895be2e3}</p>
<h3 id="Crypto-没e也能玩-94"><a href="#Crypto-没e也能玩-94" class="headerlink" title="Crypto  没e也能玩  94"></a>Crypto  没e也能玩  94</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line">c=<span class="number">312026920216195772014255984174463085443866592575942633449581804171108045852080517840578408476885673600123673447592477875543106559822653280458539889975125069364584140981069913341705738633426978886491359036285144974311751490792757751756044409664421663980721578870582548395096887840688928684149014816557276765747135567714257184475027270111822159712532338590457693333403200971556224662094381891648467959054115723744963414673861964744567056823925630723343002325605154661959863849738333074326769879861280895388423162444746726568892877802824353858845944856881876742211956986853244518521508714633279380808950337611574412909</span></span><br><span class="line">p=<span class="number">108043725609186781791705090463399988837848128384507136697546885182257613493145758848215714322999196482303958182639388180063206708575175264502030010971971799850889123915580518613554382722069874295016841596099030496486069157061211091761273568631799006187376088457421848367280401857536410610375012371577177832001</span></span><br><span class="line">q=<span class="number">121590551121540247114817509966135120751936084528211093275386628666641298457070126234836053337681325952068673362753408092990553364818851439157868686131416391201519794244659155411228907897025948436021990520853498462677797392855335364006924106615008646396883330251028071418465977013680888333091554558623089051503</span></span><br><span class="line">dp=<span class="number">11282958604593959665264348980446305500804623200078838572989469798546944577064705030092746827389207634235443944672230537015008113180165395276742807804632116181385860873677969229460704569172318227491268503039531329141563655811632035522134920788501646372986281785901019732756566066694831838769040155501078857473</span></span><br><span class="line">dq=<span class="number">46575357360806054039250786123714177813397065260787208532360436486982363496441528434309234218672688812437737096579970959403617066243685956461527617935564293219447837324227893212131933165188205281564552085623483305721400518031651417947568896538797580895484369480168587284879837144688420597737619751280559493857</span></span><br><span class="line"><span class="comment"># 计算 N 和 φ(N)</span></span><br><span class="line">N = p * q</span><br><span class="line">phi_N = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 CRT 解密</span></span><br><span class="line">m1 = <span class="built_in">pow</span>(c, dp, p)  <span class="comment"># 解密 modulo p</span></span><br><span class="line">m2 = <span class="built_in">pow</span>(c, dq, q)  <span class="comment"># 解密 modulo q</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并 m1 和 m2</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">combine</span>(<span class="params">m1, m2, p, q</span>):</span><br><span class="line">    <span class="comment"># 计算模逆</span></span><br><span class="line">    p_inv = inverse(q, p)</span><br><span class="line">    <span class="comment"># 根据 CRT 公式合并</span></span><br><span class="line">    <span class="keyword">return</span> (m1 + (m2 - m1) * p_inv % p * p) % (p * q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并得到明文 m</span></span><br><span class="line">m = combine(m1, m2, p, q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换为字节并输出 flag</span></span><br><span class="line">flag = long_to_bytes(m)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;flag = <span class="subst">&#123;flag.decode()&#125;</span>&#x27;</span>)</span><br></pre></td></tr></table></figure>


        </div>

        
            <section class="post-copyright">
                
                
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/CTF/"># CTF</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2024-10-13-NewStar2024-week3/">NewStar2024_week3</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© amino | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>